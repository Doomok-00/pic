<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>사진대지</title>

<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@500;700&display=swap" rel="stylesheet">

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body {
    margin: 0;
    background: #ccc;
    font-family: 'Noto Sans KR', sans-serif;
}

/* 버튼 영역 */
.controls {
    text-align: center;
    padding: 10px;
}

/* ===== A4 실제 출력 기준(px 고정) ===== */
.page {
    width: 794px;   /* A4 @96dpi */
    height: 1123px;
    background: #fff;
    margin: auto;
    padding: 40px;
    box-sizing: border-box;
}

/* 사진 블록 */
.photo-box {
    border: 2px solid #000;
    padding: 10px;
    margin-bottom: 20px;
}

.photo-box img {
    width: 100%;
    height: 260px;
    object-fit: contain;
    border: 1px solid #aaa;
}

/* 내용 행 */
.content-row {
    display: flex;
    border-top: 2px solid #000;
    margin-top: 5px;
}

/* “내용” 라벨 */
.label {
    width: 120px;   /* ?? 가로 2배 확장 */
    border-right: 2px solid #000;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 18px;
}

/* 텍스트 입력 */
textarea {
    flex: 1;
    height: 70px;
    font-size: 22px;
    text-align: center;

    /* ?? 세로 가운데 정렬 핵심 */
    display: flex;
    align-items: center;
    justify-content: center;

    border: none;
    resize: none;
}
</style>
</head>

<body>

<div class="controls" id="controls">
    <button onclick="copyText()">내용 동일 적용</button>
    <button onclick="savePDF()">PDF 저장</button>
</div>

<div class="page" id="pdfArea">

    <div class="photo-box">
        <input type="file" accept="image/*" onchange="loadImage(event,'img1')">
        <img id="img1">
        <div class="content-row">
            <div class="label">내용</div>
            <textarea id="text1"></textarea>
        </div>
    </div>

    <div class="photo-box">
        <input type="file" accept="image/*" onchange="loadImage(event,'img2')">
        <img id="img2">
        <div class="content-row">
            <div class="label">내용</div>
            <textarea id="text2"></textarea>
        </div>
    </div>

</div>

<script>
function loadImage(e, id) {
    const r = new FileReader();
    r.onload = () => document.getElementById(id).src = r.result;
    r.readAsDataURL(e.target.files[0]);
}

function copyText() {
    text2.value = text1.value;
}

async function savePDF() {
    document.getElementById('controls').style.display = 'none';

    const canvas = await html2canvas(pdfArea, {
        scale: 1,
        backgroundColor: '#ffffff'
    });

    const img = canvas.toDataURL('image/jpeg', 0.7);

    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF({
        orientation: 'p',
        unit: 'px',
        format: [794, 1123]   // ?? 강제 A4 1페이지
    });

    pdf.addImage(img, 'JPEG', 0, 0, 794, 1123);
    pdf.save('사진대지.pdf');

    document.getElementById('controls').style.display = 'block';
}
</script>

</body>
</html>